server default {
  listen {
    type = auth
    ipaddr = *
    port = 1812

    limit {
      max_connections = 64
      lifetime = 10
      idle_timeout = 30
    }
  }

  authorize {
    preprocess
    rewrite_calling_station_id
    authorized_macs

    if (EAP-Message) {
      eap
    } elsif (!EAP-Message && ok) {
      update control {
        Auth-Type := Accept
      }
    } else {
      reject
    }
  }

  authenticate {
    eap
  }

  post-auth {
    update request {
      Client-Shortname := "%{Client-Shortname}"
    }

    python3
  }
}
