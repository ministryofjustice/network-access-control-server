server default {
  listen {
    type = auth
    ipaddr = *
    port = 1812
    limit {
      max_connections = 64
      lifetime = 10
      idle_timeout = 30
    }
  }

authorize {
  preprocess
  rewrite_calling_station_id

  if (!EAP-Message) {
    authorized_macs

    if (!ok) {
      reject
    }
    else {
      update control {
        Auth-Type := Accept
      }
    }
  } else {
    eap
  }
}

authenticate {
  eap
}

post-auth {
  update request {
    Client-Shortname := "%{Client-Shortname}"
  }

  python3
}

preacct {
}
accounting {
}
session {
}
pre-proxy {
}
post-proxy {
	eap
}
}
